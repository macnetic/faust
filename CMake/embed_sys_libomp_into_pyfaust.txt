# the script suppose that PWD is the <build directory>/wrapper/python
file(GLOB LIBS _FaustCorePy*dylib _FaustCorePy*dll _FaustCorePy*pyd _FaustCorePy*so) # only one must exist, depending on the OS building pyfaust
list(GET LIBS 0 PYLIB)
message(STATUS "pyfaust lib: ${PYLIB}")
file(GET_RUNTIME_DEPENDENCIES LIBRARIES ${PYLIB} RESOLVED_DEPENDENCIES_VAR LIBS UNRESOLVED_DEPENDENCIES_VAR ERR_LIBS)
#message(STATUS "libs=${LIBS}")
foreach(LIB IN LISTS LIBS)
	string(REGEX MATCH ".*libomp.*" RES ${LIB})
	string(LENGTH "${RES}" RES_LEN)
	if(${RES_LEN} GREATER 0)
		message(STATUS "system libomp: ${LIB}")
		# copy the libomp in pyfaust/lib
		message("copying libomp to wrapper/python/pyfaust/lib")
		configure_file(${LIB} pyfaust/lib/libomp.${LIBEXT} COPYONLY)
	endif()
endforeach()

