clear 
close all
clc
load('results_comptime_c++_upto_8192');
t_dense_c = t_dense;
t_fact_c = t_fact;
M = 1:size(t_dense,2);
n = 2.^M;

figure('color',[1,1,1])
subplot_tight(2,1,1,0.08)
p1 = loglog(n,t_dense_c,'c.','markersize',8); p1 = p1(1);
hold on
p5 = loglog(n,mean(t_dense_c),'c','markersize',20);
p3 = loglog(n,t_fact_c,'m.','markersize',8); p3 = p3(1);
p6 = loglog(n,mean(t_fact_c),'m','markersize',20);

p11 = loglog(n,t_dense,'g.','markersize',8); p1 = p1(1);
hold on
p15 = loglog(n,mean(t_dense_c),'k.-','markersize',20);
p13 = loglog(n,t_fact_c,'y.','markersize',8); p3 = p3(1);
p16 = loglog(n,mean(t_fact_c),'g.-','markersize',20);




axis([1.9 17800 0 1])
ax=gca;
set(ax, 'XTick', 2.^M);
%title('Vector multiplication runtime comparison')
xlabel('Dimension n','fontsize',14);
ylabel('Time (s)','fontsize',14);
h=legend([p1,p5,p3,p6,p11,p15,p13,p16],'Dense multiplication C++','Dense multiplication (mean) C++','Multi-lay multiplication','Multi-layer sparse multiplication (mean)','location','northwest','fontsize',14);
set(h,'fontsize',12,'location','northwest');


subplot_tight(2,1,2,0.08)
RCtheo = 2*M./n;
RCprac = mean(t_fact_c)./mean(t_dense_c);
l1 = loglog(n,1./RCprac,'r.-');
hold on
l2 = loglog(n,1./RCtheo,'k.-');
leg = legend([l1,l2],'$\widehat{\textrm{RCG}}$','RCG');
set(leg,'fontsize',12,'location','northwest','interpreter','latex');
axis([1.9 17800 0.05 1000])%axis([1.9 17800 0 35])
xlabel('Dimension n','fontsize',14);
ylabel('Computational gain','fontsize',14);%\frac{\text{Time gain}}{\text{RC}} 
ax=gca;
set(ax, 'XTick', 2.^M);

