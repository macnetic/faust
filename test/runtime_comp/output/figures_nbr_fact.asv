close all;
clear all;

colorS={'r','g','b','m'};
suite_nbr_factor=[1,2,4,8];
DIM=1024;
density_max=0.5;
NB_SAMPLE=8;
NB_RUN=100;
n_diff_nbr_factor = length(suite_nbr_factor);
inputfile=['time_comp_NB_FACT_'];
for i=1:n_diff_nbr_factor
    inputfile=[inputfile,int2str(suite_nbr_factor(i)),'_'];   
end

inputfile=[inputfile 'DIM_' int2str(DIM) '_density_max_' num2str(density_max) '.mat'];

load(inputfile);
t=density_max/NB_SAMPLE:density_max/NB_SAMPLE:density_max;
figure,
hold on
varS_dense = [];
A=[];
legend_var=cell(1,n_diff_nbr_factor);
for i=1:n_diff_nbr_factor
    
   var_fact=eval(['t_fact_',int2str(suite_nbr_factor(i))]);
   var_dense=eval(['t_dense_',int2str(suite_nbr_factor(i))]);
   
   p=plot(t,mean(var_fact),colorS{i},'linewidth',2);
   %%plot(repmat(t,NB_RUN,1),var_fact,[colorS{i} '*']);
   %plot(t,mean(var_dense),[colorS{i} '*']);
    varS_dense=cat(3,varS_dense,var_dense);
    A=[A,p];
    legend_var{i}=['nbr factor ' int2str(suite_nbr_factor(i))];
end
 plot(t,mean(mean(varS_dense,3),1),'k','linewidth',2);
title(['Prod Faust vector DIM ' int2str(DIM)]);
xlabel('Density %','fontsize',14);
ylabel('Time (s)','fontsize',14);
h=legend(A,'Dense multiplication',legend_var,'location','northwest','fontsize',14);
set(h,'fontsize',12,'location','northwest');